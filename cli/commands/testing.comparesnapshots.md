---
layout: page
title: testing:comparesnapshots
parent_title: Commands
permalink: /cli/commands/testing.comparesnapshots.html
modification_time: 2016-08-03T12:00:00+00:00
---

This CLI command will create snapshots of the current Mpdf example templates and compare them to the base snaps.
This is a processive-intensive task and usually takes 3+ minutes.  

The snapshots are generated by creating PDFs using the PHP files found in the 
[mpdf/mpdf-examples](https://github.com/mpdf/mpdf-examples) GitHub repo and then generating images of each page.

# Dependencies

To actually run the command correctly you need:

1. [Imagemagick](http://www.imagemagick.org/script/index.php) v6.7.* installed. 
1. [PHP's Imagick extension](http://php.net/manual/en/intro.imagick.php) (available as a [Pecl extension](https://pecl.php.net/package/imagick))
1. To have run `composer install` and not `composer install --no-dev` so all the developer dependencies are downloaded

# Usage

You can run the CLI command by executing `php bin/mpdf/testing:comparesnapshots`. By default this command will compare 
the snapshots for all example PDFs. 

The exception to this is a number of excluded PDFs that aren't processed due to their size, or issues with Imagemagick:

* example14_page_numbers_ToC_Index_Bookmarks.php
* example27_CJK_using_Adobe_fonts.php
* example42_MPDFI_templatedoc.php
* example54_new_mPDF_v5-1_features_gradients_and_images.php
* example56_new_mPDF_v5-1_features_grayscale.php
* example57_new_mPDF_v5-3_active_forms.php
* example65_CMYK_colour_charts.php
* example37_barcodes.php

# Options

There are multiple options you can pass to this command to change its behaviour. 

*--template= or -t*
When set, only the selected Mpdf templates will be compared (by default all templates are compared). 
You can pass this option multiple times to compare multiple PDFs at once.

`php bin/mpdf/testing:comparesnapshots --template=example01_basic.php`

`php bin/mpdf/testing:comparesnapshots --template=example01_basic.php --template=example05_tables.php`

`php bin/mpdf/testing:comparesnapshots -t example01_basic.php`

`php bin/mpdf/testing:comparesnapshots -t example01_basic.php -t example05_tables.php`

*--example-dir= or -e*

This option allows you to change the path to the example templates directory. By default we use 
`/../vendor/mpdf/examples/` but you might want to compare a different bunch of Mpdf templates.

`php bin/mpdf/testing:comparesnapshots --example-dir=/full/path/to/folder/`

`php bin/mpdf/testing:comparesnapshots -e /full/path/to/folder/`

*--snapshot-dir= or -s*

This option allows you to change the path to the core snapshots which should be compared against. If doing a custom 
 comparison you should use this in conjunction with the `--example-dir` option. By default we use 
 `/../vendor/mpdf/snapshots/`.

`php bin/mpdf/testing:comparesnapshots --snapshot-dir=/full/path/to/folder/`

`php bin/mpdf/testing:comparesnapshots -s /full/path/to/folder/`

*--tmp-dir= or -m*

This option allows you to change the path to the temporary directory used for processing. By default we use 
`/../tmp/snapshots/`.

`php bin/mpdf/testing:comparesnapshots --tmp-dir=/full/path/to/folder/`

`php bin/mpdf/testing:comparesnapshots -m /full/path/to/folder/`

*--php-path= or -p*

This option allows you to change the PHP executable that should be used to generate the PDFs from the Mpdf templates.
We default we expect this is added as a global command `php`, but can be changed if you have multiple versions installed.

`php bin/mpdf/testing:comparesnapshots --php-path=/full/path/to/binary/php`

`php bin/mpdf/testing:comparesnapshots -p /full/path/to/binary/php`

*--diff= or -d*

This option allows you to change the percent of difference allowed between the base and new snapshots. Due to size and
processing limitations we aren't generating the snapshots in high quality. Because of this we set the default threshold 
to `0.02`, or 2%. 

`php bin/mpdf/testing:comparesnapshots --diff=0.01`

`php bin/mpdf/testing:comparesnapshots -d 0.01`