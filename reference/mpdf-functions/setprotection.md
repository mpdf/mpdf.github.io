---
layout: page
title: SetProtection()
parent_title: mPDF functions
permalink: /reference/mpdf-functions/setprotection.html
modification_time: 2015-08-05T12:01:07+00:00
---

(mPDF &ge; 1.0)

SetProtection – Encrypts and sets the PDF document permissions

# Description

void **SetProtection** ( array <span class="parameter">$permissions</span>
[, string <span class="parameter">$user_password</span>
[, string <span class="parameter">$owner_password</span>
[, integer <span class="parameter">$length</span>
]]])

Encrypts and sets the PDF document permissions for the PDF file, together with user and owner passwords.

<div class="alert alert-info" role="alert" markdown="1">
  **Note:** A default mPDF document is not encrypted, and grants full permissions to the end-user e.g.
  copying, printing, modifying.
</div>

# Parameters

<span class="parameter">$permissions</span>

: This parameter is an array which specifies the permissions granted to the end-user.

  A blank array should be passed to deny all permissions to the user. The latter 4 permissions were added in mPDF &ge;5.3 

  Using any of these last 4 permissions require 128-bit encryption and will force this mode, regardless of any value set
  for <span class="parameter">$length</span>.

  <div class="alert alert-info" role="alert" markdown="1">
    **Note:** If 128-bit encryption is used (whether by specifying
    `$length = 128` or by using any of the 4 latter permissions), the use of
    `'print'` will only allow low-resolution printing from the document; you must
    specify `'print-highres'` to allow full resolution printing.
  </div>

  **Values** (case-sensitive)

  An `array()` including any, all or none of the following. The values included are those permissions allowed:

  - `'copy'`
  - `'print'`
  - `'modify'`
  - `'annot-forms'`
  - `'fill-forms'`
  - `'extract'`
  - `'assemble'`
  - `'print-highres'`

<span class="parameter">$user_password</span>

: Specify a password required for a user to open the PDF file.

  <span class="smallblock">BLANK</span> or omitted - No password is required to open the PDF document.

<span class="parameter">$owner_password</span>

: Specify a password which will allow full access and permissions to the PDF file.

  If omitted, or you pass in `null`, a random password is generated by mPDF

<span class="parameter">$length</span>

: Specify the bit-length used for encryption. Two values are possible, `40` and `128`. The 4 latter
  <span class="parameter">$permissions</span> (see above) require 128-bit encryption, and setting any of these will
  automatically set <span class="parameter">$length</span> as `128`, overriding any value specified.

  Default: `40` - use 40-bit encryption

  **Values**

  * `40`
  * `128`

# Changelog

<table class="table">
<thead>
<tr>
  <th>Version</th>
  <th>Description</th>
</tr>
</thead> <tbody>
<tr>
  <td>2.5</td>
  <td><acronym title="Chinese-Japanese-Korean languages">CJK</acronym> files can be encrypted</td>
</tr>
<tr>
  <td>3.2</td>
  <td>Empty (blank array) <span class="parameter">$permissions</span> array correctly handled.</td>
</tr>
<tr>
  <td>5.3</td>
  <td>
    Additional <span class="parameter">$permissions</span> added, and <span class="parameter">$length</span>
    parameter added enabling 128-bit encryption
  </td>
</tr>
</tbody> </table>

# Examples

Example #1

```php
<?php
$mpdf = new \Mpdf\Mpdf();

// Encrypt the file and grant no permissions to the user to copy, print etc.
// The user will be able to open the file as no password is specified
// Owner cannot access full rights because no owner_password was set
$mpdf->SetProtection(array());

$mpdf->WriteHTML('Hello World');
$mpdf->Output('filename.pdf');

```

Example #2

```php
<?php

// Encrypt the file and grant no permissions to the user
// The user will need to use "UserPassword" to open the file
// Owner has full rights using the password "MyPassword"
$mpdf->SetProtection(array(), 'UserPassword', 'MyPassword');

// Encrypt the file and grant permissions to the user to copy and print
// No password is required to open the document
// Owner has full rights using the password "MyPassword"
$mpdf->SetProtection(array('copy','print'), '', 'MyPassword');

```
